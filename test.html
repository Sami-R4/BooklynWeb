<!-- Author Slider Section -->
<div class="author-slider-container">
  <button class="prev-btn"><i class="fas fa-chevron-left"></i></button>

  <div class="author-slider-wrapper">
    <div class="author-slider">
      <?php
        // DB connection
        $conn = new mysqli("localhost", "root", "", "booklyn");
        if ($conn->connect_error) {
            die("Connection failed: " . $conn->connect_error);
        }

        $sql = "SELECT name, picture, followers, books, rating FROM authors";
        $result = $conn->query($sql);

        if ($result->num_rows > 0) {
            foreach ($result as $row) {
                echo '
                <div class="author-card">
                  <img src="../app/author_pics/' . htmlspecialchars($row['picture']) . '" alt="' . htmlspecialchars($row['name']) . '">
                  <div class="author-name">' . htmlspecialchars($row['name']) . '</div>
                  <div class="author-info">
                    <span class="follower-count">
                      <i class="fas fa-users"></i>
                      <p>' . htmlspecialchars($row['followers']) . '</p>
                    </span>
                    <span class="book-count">
                      <i class="fas fa-book-open"></i>
                      <p>' . htmlspecialchars($row['books']) . '</p>
                    </span>
                    <span class="rating">
                      <i class="fas fa-star"></i>
                      <p>' . htmlspecialchars($row['rating']) . '</p>
                    </span>
                  </div>
                  <div class="btn-wrapper">
                    <button class="btn-follow">Follow</button>
                  </div>
                </div>
                ';
            }
        } else {
            echo "<p>No authors found.</p>";
        }
        $conn->close();
      ?>
    </div>
  </div>

  <button class="next-btn"><i class="fas fa-chevron-right"></i></button>
</div>

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function() {
  const slider = $('.author-slider');
  const cards = $('.author-card');
  const cardCount = cards.length;
  const cardWidth = cards.outerWidth(true);
  const visibleCards = 5;
  let currentPosition = 0;
  let autoSlideInterval;

  // Clone first few cards for infinite effect
  for (let i = 0; i < visibleCards; i++) {
    slider.append(cards.eq(i).clone());
  }

  function updateSliderPosition() {
    slider.css('transform', `translateX(-${currentPosition * cardWidth}px)`);
  }

  function slideNext() {
    if (currentPosition >= cardCount) {
      slider.css('transition', 'none');
      currentPosition = 0;
      updateSliderPosition();
      slider[0].offsetHeight; // force reflow
      slider.css('transition', 'transform 0.7s ease');
    }
    currentPosition++;
    updateSliderPosition();
  }

  function slidePrev() {
    if (currentPosition <= 0) {
      slider.css('transition', 'none');
      currentPosition = cardCount;
      updateSliderPosition();
      slider[0].offsetHeight; // force reflow
      slider.css('transition', 'transform 0.7s ease');
    }
    currentPosition--;
    updateSliderPosition();
  }

  function startAutoSlide() {
    autoSlideInterval = setInterval(slideNext, 3000);
  }

  function stopAutoSlide() {
    clearInterval(autoSlideInterval);
  }

  $('.next-btn').on('click', function() {
    stopAutoSlide();
    slideNext();
    startAutoSlide();
  });

  $('.prev-btn').on('click', function() {
    stopAutoSlide();
    slidePrev();
    startAutoSlide();
  });

  $('.author-slider-wrapper').hover(
    function() { stopAutoSlide(); },
    function() { startAutoSlide(); }
  );

  startAutoSlide();
});
</script>

<style>
.author-slider-container {
  display: flex;
  align-items: center;
  position: relative;
  overflow: hidden;
}

.author-slider-wrapper {
  overflow: hidden;
  width: 100%;
}

.author-slider {
  display: flex;
  transition: transform 0.7s ease;
}

.author-card {
  flex: 0 0 auto;
  width: 200px;
  margin: 0 10px;
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  text-align: center;
  padding: 15px;
}

.prev-btn, .next-btn {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: #1E293B;
  z-index: 10;
}
</style>
